Project automation and environment rules for Cursor

Docker and hot reload
- For changes in src/**, rely on Vite HMR. Do not rebuild containers.
- If the web UI does not reflect edits (common on Windows bind mounts), do:
  1) docker-compose restart web
  2) If still stale or after config changes, docker-compose up -d --build web
- Rebuild web on edits to:
  - package.json, package-lock.json, bun.lockb
  - vite.config.ts, tailwind.config.ts, postcss.config.cjs
  - tsconfig*.json
  - docker-compose.yml
  - .env, env.example

Standard commands
- Start stack: docker-compose up -d --build
- Rebuild only web: docker-compose up -d --build web
- Restart only web: docker-compose restart web
- View logs: docker-compose logs -f web

Agent workflow
- After making config/dependency changes affecting the web dev server, immediately run “docker-compose up -d --build web”.
- After typical code edits under src/**, do not rebuild; just refresh the browser. If the change is not detected within ~2 seconds, run “docker-compose restart web”.


## 9) Docker & Dev Server Rules

- Dev default: Run DB in Docker only; run API and Web natively with hot reload.
  - Compose file: `infra/docker-compose.dev.yml`
  - Start DB: `docker compose -f infra/docker-compose.dev.yml up -d`
  - After edits under `src/**`, do not rebuild containers; rely on Vite and Bun hot reload.
  - If the web UI doesn’t reflect edits within ~2s, refresh the browser first. Mongo Express can be restarted with: `docker compose -f infra/docker-compose.dev.yml restart mongo-express`.

- NAS/full mode: Use `infra/docker-compose.full.yml` with Caddy reverse proxy.
  - Web is built to static and served by nginx; API is exposed behind `/api` via Caddy.
  - Keep environment in `.env` and `.env.mongo`. Do not hardcode secrets in Dockerfiles.

- Rebuild policy:
  - Only rebuild containers in full mode when editing config/dependencies.
  - Rebuild a single service: `docker compose -f infra/docker-compose.full.yml up -d --build web` (or `api`).
